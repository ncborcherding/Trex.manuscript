---
title: "C2.Analysis"
author: "Nick Borcherding"
date: "8/15/2021"
output: html_document
---

```{r}
library(Trex)
list <- readRDS("./data/Filteredintegrated_seuratObjects.rds")

###############################################################
#Filter for barcodes with only TCR 
#This is Built into Trex, just want to save some memory upfront
################################################################
cells.chains <- rownames(list[[]][!is.na(list[["cloneType"]]),])
list <- subset(list, cells = cells.chains)

rm(cells.chains)
```

```{r}
COVID  <- runTrex(list, AA.method = "auto", 
                    AA.properties = "AF", 
                    nearest.method = "nn",
                    near.neighbor = 40,
                    n.dim = 50,
                    reduction.name = "Trex.AF")
```

